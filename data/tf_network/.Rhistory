library(limma)
# Files paths
organism <- 1 # 1: human, 2: mouse
# Read rma normalised transcriptomics files
data_file <- c(
'/Users/emanuel/Projects/data/fh_cells/human_transcriptomics/human_transcriptomics_rma.csv',
'/Users/emanuel/Projects/data/fh_cells/mouse_transcriptomics/mouse_transcriptomics_rma.csv'
)[organism]
result_file <- c(
'/Users/emanuel/Projects/projects/pymist/resources/fh_cells/human_transcriptomics.tab',
'/Users/emanuel/Projects/projects/pymist/resources/fh_cells/mouse_transcriptomics.tab'
)[organism]
design_df <- list(
cbind(KO=rep(c(1, 0), each=3), WT=rep(c(0, 1), each=3)),
cbind(KO=rep(c(1, 0), each=2), WT=rep(c(0, 1), each=2))
)[[organism]]
data_df <- read.table(data_file, sep='\t', header=T, row.names=1)
# Perform limma differential analysis
fit_1 <- lmFit(data_df, design_df)
cont_matrix <- makeContrasts(KOvsWT=KO-WT, levels=design_df)
fit_2 <- contrasts.fit(fit_1, cont_matrix)
fit_2 <- eBayes(fit_2)
result <- as.data.frame(topTable(fit_2, adjust.method='fdr', n=Inf))
# Store reults
write.table(result, result_file, sep='\t', quote=F, row.names=T)
library(limma)
library(ggplot2)
library(grid)
library(gridExtra)
# Files paths
organism = 1 # 1: human, 2: mouse
pp_human_file = c(
'~/Projects/data/fh_cells/human_phosphoproteomics/b1368p100_phosho_human_processed.tab',
'~/Projects/data/fh_cells/mouse_phosphoproteomics/b1368p100_phosho_mouse_processed.tab'
)[organism]
tp_human_file = c(
'~/Projects/data/fh_cells/human_proteomics/b1368p100_protein_human_processed.tab',
'~/Projects/data/fh_cells/mouse_proteomics/b1368p100_protein_mouse_processed.tab'
)[organism]
pp_result_file = c(
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_phospho_human_limma.tsv',
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_phospho_mouse_limma.tsv'
)[organism]
tp_result_file = c(
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_protein_human_limma.tsv',
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_protein_mouse_limma.tsv'
)[organism]
# Import data-sets
pp <- read.table(pp_human_file, sep='\t', header=T, stringsAsFactors=F, check.names=F)
tp <- read.table(tp_human_file, sep='\t', header=T, stringsAsFactors=F, check.names=F)
pp
head(pp)
pp_ss <- pp[,1:3]
pp <- pp[,-(1:3)]
pp_design <- cbind(KO=rep(c(1,0), each=6), WT=rep(c(0,1), each=6))
pp_design
pp_fit <- lmFit(pp, pp_design)
pp_cont_matrix <- makeContrasts(KOvsWT=KO-WT, levels=pp_design)
pp_fit_2 <- contrasts.fit(pp_fit, pp_cont_matrix)
pp_fit_2 <- eBayes(pp_fit_2)
pp_result <- as.data.frame(topTable(pp_fit_2, adjust.method='fdr', n=Inf))
pp_result <- cbind(pp_ss[rownames(pp_result),], pp_result)
pp_result$p.value.log10 <- -log10(pp_result$adj.P.Val)
write.table(pp_result, pp_result_file, sep='\t', quote=F, row.names=F)
# ---- Proteomics
# Preprocess data-set
tp_ss <- data.frame(tp[,1:2])
tp <- tp[,-(1:2)]
# Run differential analysis
tp_design <- cbind(KO=rep(c(1,0), each=3), WT=rep(c(0,1), each=3))
tp_fit <- lmFit(tp, tp_design)
tp_cont_matrix <- makeContrasts(KOvsWT=KO-WT, levels=tp_design)
tp_fit_2 <- contrasts.fit(tp_fit, tp_cont_matrix)
tp_fit_2 <- eBayes(tp_fit_2)
tp_result <- as.data.frame(topTable(tp_fit_2, adjust.method='fdr', n=Inf))
tp_result <- cbind(tp_ss[rownames(tp_result), ], tp_result)
tp_result$p.value.log10 <- -log10(tp_result$adj.P.Val)
# Store reults
write.table(tp_result, tp_result_file, sep='\t', quote=F, row.names=F)
# Files paths
organism = 2 # 1: human, 2: mouse
pp_human_file = c(
'~/Projects/data/fh_cells/human_phosphoproteomics/b1368p100_phosho_human_processed.tab',
'~/Projects/data/fh_cells/mouse_phosphoproteomics/b1368p100_phosho_mouse_processed.tab'
)[organism]
tp_human_file = c(
'~/Projects/data/fh_cells/human_proteomics/b1368p100_protein_human_processed.tab',
'~/Projects/data/fh_cells/mouse_proteomics/b1368p100_protein_mouse_processed.tab'
)[organism]
pp_result_file = c(
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_phospho_human_limma.tsv',
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_phospho_mouse_limma.tsv'
)[organism]
tp_result_file = c(
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_protein_human_limma.tsv',
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_protein_mouse_limma.tsv'
)[organism]
# Import data-sets
pp <- read.table(pp_human_file, sep='\t', header=T, stringsAsFactors=F, check.names=F)
tp <- read.table(tp_human_file, sep='\t', header=T, stringsAsFactors=F, check.names=F)
# ---- Phosphoproteomics
# Preprocess data-set
pp_ss <- pp[,1:3]
pp <- pp[,-(1:3)]
# Run differential analysis
pp_design <- cbind(KO=rep(c(1,0), each=6), WT=rep(c(0,1), each=6))
pp_fit <- lmFit(pp, pp_design)
pp_cont_matrix <- makeContrasts(KOvsWT=KO-WT, levels=pp_design)
pp_fit_2 <- contrasts.fit(pp_fit, pp_cont_matrix)
pp_fit_2 <- eBayes(pp_fit_2)
pp_result <- as.data.frame(topTable(pp_fit_2, adjust.method='fdr', n=Inf))
pp_result <- cbind(pp_ss[rownames(pp_result),], pp_result)
pp_result$p.value.log10 <- -log10(pp_result$adj.P.Val)
# Store reults
write.table(pp_result, pp_result_file, sep='\t', quote=F, row.names=F)
# ---- Proteomics
# Preprocess data-set
tp_ss <- data.frame(tp[,1:2])
tp <- tp[,-(1:2)]
# Run differential analysis
tp_design <- cbind(KO=rep(c(1,0), each=3), WT=rep(c(0,1), each=3))
tp_fit <- lmFit(tp, tp_design)
tp_cont_matrix <- makeContrasts(KOvsWT=KO-WT, levels=tp_design)
tp_fit_2 <- contrasts.fit(tp_fit, tp_cont_matrix)
tp_fit_2 <- eBayes(tp_fit_2)
tp_result <- as.data.frame(topTable(tp_fit_2, adjust.method='fdr', n=Inf))
tp_result <- cbind(tp_ss[rownames(tp_result), ], tp_result)
tp_result$p.value.log10 <- -log10(tp_result$adj.P.Val)
# Store reults
write.table(tp_result, tp_result_file, sep='\t', quote=F, row.names=F)
library(piano)
library(limma)
# Files paths
organism = 2 # 1: human, 2: mouse
pp_human_file = c(
'~/Projects/data/fh_cells/human_phosphoproteomics/b1368p100_phosho_human_processed.tab',
'~/Projects/data/fh_cells/mouse_phosphoproteomics/b1368p100_phosho_mouse_processed.tab'
)[organism]
tp_human_file = c(
'~/Projects/data/fh_cells/human_proteomics/b1368p100_protein_human_processed.tab',
'~/Projects/data/fh_cells/mouse_proteomics/b1368p100_protein_mouse_processed.tab'
)[organism]
pp_result_file = c(
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_phospho_human_limma.tsv',
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_phospho_mouse_limma.tsv'
)[organism]
tp_result_file = c(
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_protein_human_limma.tsv',
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_protein_mouse_limma.tsv'
)[organism]
# Import data-sets
pp <- read.table(pp_human_file, sep='\t', header=T, stringsAsFactors=F, check.names=F)
tp <- read.table(tp_human_file, sep='\t', header=T, stringsAsFactors=F, check.names=F)
# ---- Phosphoproteomics
# Preprocess data-set
pp_ss <- pp[,1:3]
pp <- pp[,-(1:3)]
# Run differential analysis
pp_design <- cbind(KO=rep(c(1,0), each=6), WT=rep(c(0,1), each=6))
pp_fit <- lmFit(pp, pp_design)
pp_cont_matrix <- makeContrasts(KOvsWT=KO/WT, levels=pp_design)
pp_fit_2 <- contrasts.fit(pp_fit, pp_cont_matrix)
pp_fit_2 <- eBayes(pp_fit_2)
pp_result <- as.data.frame(topTable(pp_fit_2, adjust.method='fdr', n=Inf))
pp_result <- cbind(pp_ss[rownames(pp_result),], pp_result)
pp_result$p.value.log10 <- -log10(pp_result$adj.P.Val)
head(pp_result)
head(pp_result, 20)
head(pp_result, 30)
head(pp_result, 40)
head(pp_result, 60)
head(pp_result,100)
tail(pp_result,100)
library(limma)
# Files paths
organism = 2 # 1: human, 2: mouse
pp_human_file = c(
'~/Projects/data/fh_cells/human_phosphoproteomics/b1368p100_phosho_human_processed.tab',
'~/Projects/data/fh_cells/mouse_phosphoproteomics/b1368p100_phosho_mouse_processed.tab'
)[organism]
tp_human_file = c(
'~/Projects/data/fh_cells/human_proteomics/b1368p100_protein_human_processed.tab',
'~/Projects/data/fh_cells/mouse_proteomics/b1368p100_protein_mouse_processed.tab'
)[organism]
pp_result_file = c(
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_phospho_human_limma.tsv',
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_phospho_mouse_limma.tsv'
)[organism]
tp_result_file = c(
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_protein_human_limma.tsv',
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_protein_mouse_limma.tsv'
)[organism]
# Import data-sets
pp <- read.table(pp_human_file, sep='\t', header=T, stringsAsFactors=F, check.names=F)
tp <- read.table(tp_human_file, sep='\t', header=T, stringsAsFactors=F, check.names=F)
# ---- Phosphoproteomics
# Preprocess data-set
pp_ss <- pp[,1:3]
pp <- pp[,-(1:3)]
# Run differential analysis
pp_design <- cbind(KO=rep(c(1,0), each=6), WT=rep(c(0,1), each=6))
pp_fit <- lmFit(pp, pp_design)
pp_cont_matrix <- makeContrasts(KOvsWT=KO-WT, levels=pp_design)
pp_fit_2 <- contrasts.fit(pp_fit, pp_cont_matrix)
pp_fit_2 <- eBayes(pp_fit_2)
pp_result <- as.data.frame(topTable(pp_fit_2, adjust.method='fdr', n=Inf))
pp_result <- cbind(pp_ss[rownames(pp_result),], pp_result)
pp_result$p.value.log10 <- -log10(pp_result$adj.P.Val)
head(pp_result)
library(limma)
# Files paths
organism = 2 # 1: human, 2: mouse
pp_human_file = c(
'~/Projects/data/fh_cells/human_phosphoproteomics/b1368p100_phosho_human_processed.tab',
'~/Projects/data/fh_cells/mouse_phosphoproteomics/b1368p100_phosho_mouse_processed.tab'
)[organism]
tp_human_file = c(
'~/Projects/data/fh_cells/human_proteomics/b1368p100_protein_human_processed.tab',
'~/Projects/data/fh_cells/mouse_proteomics/b1368p100_protein_mouse_processed.tab'
)[organism]
pp_result_file = c(
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_phospho_human_limma.tsv',
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_phospho_mouse_limma.tsv'
)[organism]
tp_result_file = c(
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_protein_human_limma.tsv',
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_protein_mouse_limma.tsv'
)[organism]
# Import data-sets
pp <- read.table(pp_human_file, sep='\t', header=T, stringsAsFactors=F, check.names=F)
tp <- read.table(tp_human_file, sep='\t', header=T, stringsAsFactors=F, check.names=F)
# ---- Phosphoproteomics
# Preprocess data-set
pp_ss <- pp[,1:3]
pp <- pp[,-(1:3)]
# Run differential analysis
pp_design <- cbind(KO=rep(c(1,0), each=6), WT=rep(c(0,1), each=6))
pp_fit <- lmFit(pp, pp_design)
pp_cont_matrix <- makeContrasts(KOvsWT=KO-WT, levels=pp_design)
pp_fit_2 <- contrasts.fit(pp_fit, pp_cont_matrix)
pp_fit_2 <- eBayes(pp_fit_2)
pp_result <- as.data.frame(topTable(pp_fit_2, adjust.method='fdr', n=Inf))
pp_result <- cbind(pp_ss[rownames(pp_result),], pp_result)
pp_result$p.value.log10 <- -log10(pp_result$adj.P.Val)
library(limma)
# Files paths
organism = 1 # 1: human, 2: mouse
pp_human_file = c(
'~/Projects/data/fh_cells/human_phosphoproteomics/b1368p100_phosho_human_processed.tab',
'~/Projects/data/fh_cells/mouse_phosphoproteomics/b1368p100_phosho_mouse_processed.tab'
)[organism]
tp_human_file = c(
'~/Projects/data/fh_cells/human_proteomics/b1368p100_protein_human_processed.tab',
'~/Projects/data/fh_cells/mouse_proteomics/b1368p100_protein_mouse_processed.tab'
)[organism]
pp_result_file = c(
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_phospho_human_limma.tsv',
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_phospho_mouse_limma.tsv'
)[organism]
tp_result_file = c(
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_protein_human_limma.tsv',
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_protein_mouse_limma.tsv'
)[organism]
# Import data-sets
pp <- read.table(pp_human_file, sep='\t', header=T, stringsAsFactors=F, check.names=F)
tp <- read.table(tp_human_file, sep='\t', header=T, stringsAsFactors=F, check.names=F)
# ---- Phosphoproteomics
# Preprocess data-set
pp_ss <- pp[,1:3]
pp <- pp[,-(1:3)]
# Run differential analysis
pp_design <- cbind(KO=rep(c(1,0), each=6), WT=rep(c(0,1), each=6))
pp_fit <- lmFit(pp, pp_design)
pp_cont_matrix <- makeContrasts(KOvsWT=KO-WT, levels=pp_design)
pp_fit_2 <- contrasts.fit(pp_fit, pp_cont_matrix)
pp_fit_2 <- eBayes(pp_fit_2)
pp_result <- as.data.frame(topTable(pp_fit_2, adjust.method='fdr', n=Inf))
pp_result <- cbind(pp_ss[rownames(pp_result),], pp_result)
pp_result$p.value.log10 <- -log10(pp_result$adj.P.Val)
head(pp_result)
head(pp_result, 20)
pp_result$logFC
2^pp_result$logFC
boxplot(2^pp_result$logFC)
boxplot(pp_result$logFC)
boxplot(2^pp_result$logFC)
cor.test(2^pp_result$logFC, pp_result$logFC)
cor.test(2^pp_result$logFC, pp_result$logFC, method='spearman')
library(limma)
# Files paths
organism = 1 # 1: human, 2: mouse
pp_human_file = c(
'~/Projects/data/fh_cells/human_phosphoproteomics/b1368p100_phosho_human_processed.tab',
'~/Projects/data/fh_cells/mouse_phosphoproteomics/b1368p100_phosho_mouse_processed.tab'
)[organism]
tp_human_file = c(
'~/Projects/data/fh_cells/human_proteomics/b1368p100_protein_human_processed.tab',
'~/Projects/data/fh_cells/mouse_proteomics/b1368p100_protein_mouse_processed.tab'
)[organism]
pp_result_file = c(
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_phospho_human_limma.tsv',
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_phospho_mouse_limma.tsv'
)[organism]
tp_result_file = c(
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_protein_human_limma.tsv',
'~/Projects/projects/pymist/resources/fh_cells/b1368p100_protein_mouse_limma.tsv'
)[organism]
# Import data-sets
pp <- read.table(pp_human_file, sep='\t', header=T, stringsAsFactors=F, check.names=F)
tp <- read.table(tp_human_file, sep='\t', header=T, stringsAsFactors=F, check.names=F)
# ---- Phosphoproteomics
# Preprocess data-set
pp_ss <- pp[,1:3]
pp <- pp[,-(1:3)]
# Run differential analysis
pp_design <- cbind(KO=rep(c(1,0), each=6), WT=rep(c(0,1), each=6))
pp_fit <- lmFit(pp, pp_design)
pp_cont_matrix <- makeContrasts(KOvsWT=KO-WT, levels=pp_design)
pp_fit_2 <- contrasts.fit(pp_fit, pp_cont_matrix)
pp_fit_2 <- eBayes(pp_fit_2)
pp_result <- as.data.frame(topTable(pp_fit_2, adjust.method='fdr', n=Inf))
pp_result <- cbind(pp_ss[rownames(pp_result),], pp_result)
pp_result$p.value.log10 <- -log10(pp_result$adj.P.Val)
# Store reults
write.table(pp_result, pp_result_file, sep='\t', quote=F, row.names=F)
# ---- Proteomics
# Preprocess data-set
tp_ss <- data.frame(tp[,1:2])
tp <- tp[,-(1:2)]
# Run differential analysis
tp_design <- cbind(KO=rep(c(1,0), each=3), WT=rep(c(0,1), each=3))
tp_fit <- lmFit(tp, tp_design)
tp_cont_matrix <- makeContrasts(KOvsWT=KO-WT, levels=tp_design)
tp_fit_2 <- contrasts.fit(tp_fit, tp_cont_matrix)
tp_fit_2 <- eBayes(tp_fit_2)
tp_result <- as.data.frame(topTable(tp_fit_2, adjust.method='fdr', n=Inf))
tp_result <- cbind(tp_ss[rownames(tp_result), ], tp_result)
tp_result$p.value.log10 <- -log10(tp_result$adj.P.Val)
# Store reults
write.table(tp_result, tp_result_file, sep='\t', quote=F, row.names=F)
library(limma)
# Files paths
organism = 1 # 1: human, 2: mouse
pp_human_file = c(
'~/Projects/data/fh_cells/human_phosphoproteomics/b1368p100_phosho_human_processed.tab',
'~/Projects/data/fh_cells/mouse_phosphoproteomics/b1368p100_phosho_mouse_processed.tab'
)[organism]
tp_human_file = c(
'~/Projects/data/fh_cells/human_proteomics/b1368p100_protein_human_processed.tab',
'~/Projects/data/fh_cells/mouse_proteomics/b1368p100_protein_mouse_processed.tab'
)[organism]
pp_result_file = c(
'~/Projects/projects/pymist/resources/fh_cells/files/b1368p100_phospho_human_limma.tsv',
'~/Projects/projects/pymist/resources/fh_cells/files/b1368p100_phospho_mouse_limma.tsv'
)[organism]
tp_result_file = c(
'~/Projects/projects/pymist/resources/fh_cells/files/b1368p100_protein_human_limma.tsv',
'~/Projects/projects/pymist/resources/fh_cells/files/b1368p100_protein_mouse_limma.tsv'
)[organism]
# Import data-sets
pp <- read.table(pp_human_file, sep='\t', header=T, stringsAsFactors=F, check.names=F)
tp <- read.table(tp_human_file, sep='\t', header=T, stringsAsFactors=F, check.names=F)
# ---- Phosphoproteomics
# Preprocess data-set
pp_ss <- pp[,1:3]
pp <- pp[,-(1:3)]
# Run differential analysis
pp_design <- cbind(KO=rep(c(1,0), each=6), WT=rep(c(0,1), each=6))
pp_fit <- lmFit(pp, pp_design)
pp_cont_matrix <- makeContrasts(KOvsWT=KO-WT, levels=pp_design)
pp_fit_2 <- contrasts.fit(pp_fit, pp_cont_matrix)
pp_fit_2 <- eBayes(pp_fit_2)
pp_result <- as.data.frame(topTable(pp_fit_2, adjust.method='fdr', n=Inf))
pp_result <- cbind(pp_ss[rownames(pp_result),], pp_result)
pp_result$p.value.log10 <- -log10(pp_result$adj.P.Val)
# Store reults
write.table(pp_result, pp_result_file, sep='\t', quote=F, row.names=F)
# ---- Proteomics
# Preprocess data-set
tp_ss <- data.frame(tp[,1:2])
tp <- tp[,-(1:2)]
# Run differential analysis
tp_design <- cbind(KO=rep(c(1,0), each=3), WT=rep(c(0,1), each=3))
tp_fit <- lmFit(tp, tp_design)
tp_cont_matrix <- makeContrasts(KOvsWT=KO-WT, levels=tp_design)
tp_fit_2 <- contrasts.fit(tp_fit, tp_cont_matrix)
tp_fit_2 <- eBayes(tp_fit_2)
tp_result <- as.data.frame(topTable(tp_fit_2, adjust.method='fdr', n=Inf))
tp_result <- cbind(tp_ss[rownames(tp_result), ], tp_result)
tp_result$p.value.log10 <- -log10(tp_result$adj.P.Val)
# Store reults
write.table(tp_result, tp_result_file, sep='\t', quote=F, row.names=F)
library(limma)
# Files paths
organism = 1 # 1: human, 2: mouse
pp_human_file = c(
'~/Projects/data/fh_cells/human_phosphoproteomics/b1368p100_phosho_human_processed.tab',
'~/Projects/data/fh_cells/mouse_phosphoproteomics/b1368p100_phosho_mouse_processed.tab'
)[organism]
tp_human_file = c(
'~/Projects/data/fh_cells/human_proteomics/b1368p100_protein_human_processed.tab',
'~/Projects/data/fh_cells/mouse_proteomics/b1368p100_protein_mouse_processed.tab'
)[organism]
pp_result_file = c(
'~/Projects/projects/pymist/resources/fh_cells/files/b1368p100_phospho_human_limma.tsv',
'~/Projects/projects/pymist/resources/fh_cells/files/b1368p100_phospho_mouse_limma.tsv'
)[organism]
tp_result_file = c(
'~/Projects/projects/pymist/resources/fh_cells/files/b1368p100_protein_human_limma.tsv',
'~/Projects/projects/pymist/resources/fh_cells/files/b1368p100_protein_mouse_limma.tsv'
)[organism]
# Import data-sets
pp <- read.table(pp_human_file, sep='\t', header=T, stringsAsFactors=F, check.names=F)
tp <- read.table(tp_human_file, sep='\t', header=T, stringsAsFactors=F, check.names=F)
# ---- Phosphoproteomics
# Preprocess data-set
pp_ss <- pp[,1:3]
pp <- pp[,-(1:3)]
# Run differential analysis
pp_design <- cbind(KO=rep(c(1,0), each=6), WT=rep(c(0,1), each=6))
pp_fit <- lmFit(pp, pp_design)
pp_cont_matrix <- makeContrasts(KOvsWT=KO-WT, levels=pp_design)
pp_fit_2 <- contrasts.fit(pp_fit, pp_cont_matrix)
pp_fit_2 <- eBayes(pp_fit_2)
pp_result <- as.data.frame(topTable(pp_fit_2, adjust.method='fdr', n=Inf))
pp_result <- cbind(pp_ss[rownames(pp_result),], pp_result)
pp_result$p.value.log10 <- -log10(pp_result$adj.P.Val)
# Store reults
write.table(pp_result, pp_result_file, sep='\t', quote=F, row.names=F)
# ---- Proteomics
# Preprocess data-set
tp_ss <- data.frame(tp[,1:3])
tp <- tp[,-(1:3)]
# Run differential analysis
tp_design <- cbind(KO=rep(c(1,0), each=3), WT=rep(c(0,1), each=3))
tp_fit <- lmFit(tp, tp_design)
tp_cont_matrix <- makeContrasts(KOvsWT=KO-WT, levels=tp_design)
tp_fit_2 <- contrasts.fit(tp_fit, tp_cont_matrix)
tp_fit_2 <- eBayes(tp_fit_2)
tp_result <- as.data.frame(topTable(tp_fit_2, adjust.method='fdr', n=Inf))
tp_result <- cbind(tp_ss[rownames(tp_result), ], tp_result)
tp_result$p.value.log10 <- -log10(tp_result$adj.P.Val)
# Store reults
write.table(tp_result, tp_result_file, sep='\t', quote=F, row.names=F)
load('~/Projects/projects/pymist/resources/fh_cells/files/cami_paper/data1_limmaFC.RData')
limmaEst
head(limmaEst)
load('~/Projects/projects/pymist/resources/fh_cells/files/cami_paper/dataObjects_2_2.RData')
d12.log.dN
head(d12.log.dN)
dim(d12.log.dN)
limma.FCvCtrl.d6.NAr
head(limma.FCvCtrl.d6.NAr)
head(limma.FCvCtrl.d6.pval.NAr)
head(limma.alone.d6.NAr)
head(d12.log.dN)
write.table(limma.FCvCtrl.d6.NAr, '~/Projects/projects/pymist/resources/fh_cells/files/cami_paper/limma_logfc.tab', sep='\t', quote=F)
load('~/Downloads/data2.Rdata')
limma.FCvCtrl.d6.NAr
GMM.res.ID.2
head(GMM.res.ID.2)
load('~/Projects/data/sanger/methylation/PANCAN_informative.rdata')
write.table(PC_tBEM, '~/Projects/data/tcga/methylation/pancan_informative_islands.tab', sep='\t', quote=F)
t.test(2, 3)
?t.test
t.test([1], [2])
t.test(c(1), c(2)
)
t.test(c(1), c(2,3,4))
t.test(c(2,3,4))
load('~/Projects/data/sanger/drugs/DRUG_ANALYSIS_SET_20150123.rdata')
DRUG_ANALYSIS_SET
head(DRUG_ANALYSIS_SET)
write.table(DRUG_ANALYSIS_SET, '~/Projects/data/sanger/drugs/drug_samplesheet.tab', sep='/t', quote=F, row.names = F)
write.table(DRUG_ANALYSIS_SET, '~/Projects/data/sanger/drugs/drug_samplesheet.tab', sep='\t', quote=F, row.names = F)
setwd('/Users/emanuel/Projects/projects/yeast_phospho/')
setwd('/Users/emanuel/Projects/projects/yeast_phospho/data/gene_expresion/')
data_1 = readRDS('Chua_2006_zscores_51tfs_parsed.rds')
data_2 = readRDS('Hu_2006_xscores_269tfs_parsed.rds')
data_3 = readRDS('Kemmeren_2014_zscores_parsed.rds')
typeof(data_1)
data_1
head(data_1)
head(data.frame(data_1))
head(rbind(c(data.frame(data_1), data.frame(data_2))))
data = rbind(c(data.frame(data_1), data.frame(data_2)))
data
data = cbind(c(data.frame(data_1), data.frame(data_2)))
data
merge(data_1, data_2)
data = merge(data.frame(data_1), data.frame(data_2))
head(data)
write.table(data_1, 'Chua_2006_zscores_51tfs_parsed.tab', sep='\t')
write.table(data_1, 'Chua_2006_zscores_51tfs_parsed.tab', sep='\t', quote = F)
write.table(data_1, 'Chua_2006_zscores_51tfs_parsed.tab', sep='\t', quote = F, row.names = F)
head(data_2)
write.table(data_2, 'Hu_2006_xscores_269tfs_parsed.tab', sep='\t', quote = F, row.names = F)
head(data_3)
write.table(data_3, 'Kemmeren_2014_zscores_parsed.tab', sep='\t', quote = F, row.names = F)
net_1 = readRDS('tf_gene_network_binding_sites_posterior_90.rds')
net_2 = readRDS('tf_gene_network_chip_only.rds')
head(net_1)
write.table(net_1, 'tf_gene_network_binding_sites_posterior_90.tab', sep='\t', quote = F, row.names = F)
write.table(net_2, 'tf_gene_network_chip_only.tab', sep='\t', quote = F, row.names = F)
setwd('../tf_network/\')
dsa
sad
''
as;d';sdk'
setwd('../tf_network/')
conv_table = readRDS('orf_name_dataframe.rds')
write.table(conv_table, 'orf_name_dataframe.tab', sep='\t', quote = F, row.names = F)
